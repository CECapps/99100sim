<!DOCTYPE html>
<html>
    <head>
        <title>99100 Sim</title>
        <link rel="icon" href="favicon.png" sizes="100x100" type="image/png">
        <script src="./viz.js"></script>
        <script src="./txt2asm.js"></script>
        <script>
            /** @type {Simulation} sim */
            window.sim = '';
        </script>
<script type="module">
// @ts-check
/**
 * For Very Important Reasons, you can only import modules if you yourself are
 * a module.  But if you're a module, you can't actually do certain things.
 * So, let's stash what we need in the global window object and switch back.
 * @TODO I'm sure there's a better way to deal with this problem.
 **/
import { Simulation } from "./classes/Simulation.js";

/** @type {Simulation} sim */
window.sim = new Simulation();
for (let i = 0; i < 32768; i++) {
    window.sim.state.setWord(i, 0x1000);
}
window.sim.resetIVs();
// And away we go!
console.info('Outside: calling run(50)')
console.info('Outside: run(50) result state: "%s"', window.sim.run(50));
</script>

<!-- AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA -->

<script>
"use strict";

window.addEventListener('DOMContentLoaded', tab_fixer_onload);
window.addEventListener('DOMContentLoaded', viz_redraw_init);
window.addEventListener('memory_updated', viz_request_redraw);

/*
window.addEventListener('memory_updated', function (event) {
        viz_needs_redraw = true;
    });
*/

</script>

<!-- AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA -->

        <style>
            /* https://paletton.com/#uid=53u0I0kgX6j8zeBb67ClS4Srx3b */
            html {
                color: #f0f0f0;
                background-color: #101a20;
                /* font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif; */
                font-family: 'Cascadia Code', 'Consolas', 'Courier', fixed;
                font-weight: 100;
                font-size: 0.2in;
            }
            input, textarea {
                color: #f0f0f0;
                background-color: #101a20;
                font-family: 'Cascadia Code', 'Consolas', 'Courier', fixed;
                font-weight: normal;
                font-size: 1rem;
            }

            #flexcontainer {
                display: flex;
            }
        </style>
    </head>
    <body>
        <div id="flexcontainer">
            <div style="flex: auto;">
                <textarea id="codebox" rows="10" cols="40" spellcheck="false" ></textarea>
            </div>
            <div id="viz" style="flex: auto;"></div>
        </div>
    </body>
</html>
